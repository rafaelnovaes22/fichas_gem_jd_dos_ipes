{"version":3,"sources":["../../../../../Fichas_GEM/src/app/dashboard/alunos/%5Bid%5D/editar/form.tsx/__nextjs-internal-proxy.mjs","../../../../../Fichas_GEM/src/app/dashboard/alunos/%5Bid%5D/editar/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const EditarAlunoForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call EditarAlunoForm() from the server but EditarAlunoForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Fichas_GEM/src/app/dashboard/alunos/[id]/editar/form.tsx\",\n    \"EditarAlunoForm\",\n);\n","import { notFound } from \"next/navigation\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/lib/auth\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { EditarAlunoForm } from \"./form\";\r\n\r\ninterface EditarAlunoPageProps {\r\n    params: Promise<{ id: string }>;\r\n}\r\n\r\nexport default async function EditarAlunoPage({ params }: EditarAlunoPageProps) {\r\n    const session = await getServerSession(authOptions);\r\n    const { id } = await params;\r\n\r\n    const aluno = await prisma.aluno.findUnique({\r\n        where: { id },\r\n        include: {\r\n            instrutor: true,\r\n            instrutor2: true,\r\n        },\r\n    });\r\n\r\n    if (!aluno) {\r\n        notFound();\r\n    }\r\n\r\n    // Verificar permiss√£o\r\n    const isAdmin = session?.user?.role === \"ADMIN\";\r\n    const isInstrutorPrimary = aluno.instrutor.usuarioId === session?.user?.id;\r\n    const isInstrutorSecondary = aluno.instrutor2?.usuarioId === session?.user?.id;\r\n\r\n    if (!isAdmin && !isInstrutorPrimary && !isInstrutorSecondary) {\r\n        notFound();\r\n    }\r\n\r\n    const instrumentos = await prisma.instrumento.findMany({\r\n        where: { ativo: true },\r\n        orderBy: [{ categoria: \"asc\" }, { nome: \"asc\" }],\r\n    });\r\n\r\n    const fases = await prisma.fase.findMany({\r\n        where: { ativo: true },\r\n        orderBy: { ordem: \"asc\" },\r\n    });\r\n\r\n    const instrutores = await prisma.instrutor.findMany({\r\n        include: { usuario: true },\r\n        orderBy: { usuario: { nome: \"asc\" } },\r\n    });\r\n\r\n    return (\r\n        <EditarAlunoForm\r\n            aluno={{\r\n                id: aluno.id,\r\n                nome: aluno.nome,\r\n                dataNascimento: aluno.dataNascimento?.toISOString() || null,\r\n                telefone: aluno.telefone,\r\n                email: aluno.email,\r\n                congregacao: aluno.congregacao,\r\n                instrumentoId: aluno.instrumentoId,\r\n                faseId: aluno.faseId,\r\n                autorizacaoDados: aluno.autorizacaoDados,\r\n                instrutorId: aluno.instrutor.id,\r\n                instrutor2Id: aluno.instrutor2?.id || null,\r\n            }}\r\n            instrumentos={instrumentos}\r\n            fases={fases}\r\n            instrutores={instrutores}\r\n        />\r\n    );\r\n}\r\n"],"names":[],"mappings":"8XAEO,IAAM,EAAkB,CAAA,EAAA,AAD/B,EAAA,CAAA,CAAA,OAC+B,uBAAA,AAAuB,EAClD,WAAa,MAAM,AAAI,MAAM,4OAA8O,EAC3Q,yFACA,0EAHG,IAAM,EAAkB,CAAA,EAAA,AAD/B,EAAA,CAAA,CAAA,OAC+B,uBAAA,AAAuB,EAClD,WAAa,MAAM,AAAI,MAAM,4OAA8O,EAC3Q,qEACA,uHCLJ,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAMe,eAAe,EAAgB,QAAE,CAAM,CAAwB,EAC1E,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAC5C,CAAE,IAAE,CAAE,CAAG,MAAM,EAEf,EAAQ,MAAM,EAAA,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,CACxC,MAAO,IAAE,CAAG,EACZ,QAAS,CACL,WAAW,EACX,WAAY,EAChB,CACJ,EAEI,CAAC,GACD,CAAA,EAAA,CADQ,CACR,QAAA,AAAQ,IAIZ,IAAM,EAAU,GAAS,MAAM,OAAS,QAClC,EAAqB,EAAM,SAAS,CAAC,SAAS,GAAK,GAAS,MAAM,GAClE,EAAuB,EAAM,UAAU,EAAE,YAAc,GAAS,MAAM,EAExE,CAAC,GAAY,GAAuB,GACpC,CAAA,CADY,CACZ,EAAA,QAAA,AAAQ,GAD2B,CAIvC,EAJ8D,EAIxD,EAAe,MAAM,EAAA,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CACnD,MAAO,CAAE,OAAO,CAAK,EACrB,QAAS,CAAC,CAAE,UAAW,KAAM,EAAG,CAAE,KAAM,KAAM,EAAE,AACpD,GAEM,EAAQ,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CACrC,MAAO,CAAE,OAAO,CAAK,EACrB,QAAS,CAAE,MAAO,KAAM,CAC5B,GAEM,EAAc,MAAM,EAAA,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAChD,QAAS,CAAE,QAAS,EAAK,EACzB,QAAS,CAAE,QAAS,CAAE,KAAM,KAAM,CAAE,CACxC,GAEA,MACI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CACZ,MAAO,CACH,GAAI,EAAM,EAAE,CACZ,KAAM,EAAM,IAAI,CAChB,eAAgB,EAAM,cAAc,EAAE,eAAiB,KACvD,SAAU,EAAM,QAAQ,CACxB,MAAO,EAAM,KAAK,CAClB,YAAa,EAAM,WAAW,CAC9B,cAAe,EAAM,aAAa,CAClC,OAAQ,EAAM,MAAM,CACpB,iBAAkB,EAAM,gBAAgB,CACxC,YAAa,EAAM,SAAS,CAAC,EAAE,CAC/B,aAAc,EAAM,UAAU,EAAE,IAAM,IAC1C,EACA,aAAc,EACd,MAAO,EACP,YAAa,GAGzB","ignoreList":[0]}