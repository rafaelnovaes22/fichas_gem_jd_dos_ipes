module.exports=[34486,a=>{"use strict";var b=a.i(66953),c=a.i(85472),d=a.i(32655);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},70256,a=>{"use strict";var b=a.i(66953),c=a.i(85472),d=a.i(34486),e=a.i(34959),f=a.i(61848);let g=(0,f.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),h=(0,f.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function i({fichaId:a,aulas:f,avaliacoes:i,mediaFinal:j,apto:k,encarregadoLocal:l,instrutorId:m,tipoAula:n,nivel:o,livro:p}){let[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)([]);(0,c.useEffect)(()=>{fetch("/api/msa/fases").then(a=>a.json()).then(a=>v(a)).catch(a=>console.error("Erro ao buscar fases MSA:",a))},[]);let w=Array.from({length:20},(a,b)=>f.find(a=>a.numeroAula===b+1)||{id:null,numeroAula:b+1,data:null,anotacoes:"",topicoMsaId:null,presenca:!1,ausencia:!1,justificativa:null,vistoInstrutor:!1,instrutor:null}),x=Array.from({length:3},(a,b)=>i.find(a=>a.numeroAvaliacao===b+1)||{id:null,numeroAvaliacao:b+1,data:null,nota:null,anotacoes:"",presenca:!1,ausencia:!1,justificativa:null,vistoInstrutor:!1,instrutor:null}),y=async(b,c)=>{r(!0);try{await fetch(`/api/fichas/${a}/aulas`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numeroAula:b,...c,instrutorId:m})}),window.location.reload()}catch(a){console.error("Erro ao salvar aula:",a)}finally{r(!1)}},z=async(b,c)=>{r(!0);try{await fetch(`/api/fichas/${a}/avaliacoes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numeroAvaliacao:b,...c})}),window.location.reload()}catch(a){console.error("Erro ao salvar avaliação:",a)}finally{r(!1)}},A=x.filter(a=>null!==a.nota).map(a=>a.nota),B=A.length>0?A.reduce((a,b)=>a+b,0)/A.length:null;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"PROGRAMAÇÃO DE AULAS TEÓRICAS"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium w-16",children:"Nº"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium w-32",children:"Data"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium min-w-[200px]",children:"Tópico MSA / Assunto"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Anotações"}),(0,b.jsx)("th",{className:"px-3 py-2 text-center font-medium w-10",children:"P."}),(0,b.jsx)("th",{className:"px-3 py-2 text-center font-medium w-10",children:"A."}),(0,b.jsx)("th",{className:"px-3 py-2 text-center font-medium w-16",children:"Just."}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium w-24",children:"Visto"})]})}),(0,b.jsx)("tbody",{children:w.map((a,c)=>(0,b.jsxs)("tr",{onClick:()=>t(c),children:[(0,b.jsx)("td",{className:"px-3 py-2 font-medium",children:String(a.numeroAula).padStart(2,"0")}),(0,b.jsx)("td",{className:"px-3 py-2 text-center",children:(0,b.jsx)("input",{type:"date",defaultValue:a.data?new Date(a.data).toISOString().split("T")[0]:"",onChange:b=>y(a.numeroAula,{data:b.target.value?new Date(b.target.value):void 0}),className:"w-[130px] px-2 py-1 border rounded text-sm"})}),(0,b.jsx)("td",{className:"px-3 py-2",children:("TEORIA_MUSICAL"===n||"SOLFEJO"===n)&&(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsxs)("select",{value:a.topicoMsaId||"",onChange:b=>y(a.numeroAula,{topicoMsaId:b.target.value||null}),className:"w-full px-2 py-1 border rounded text-sm max-w-[250px]",children:[(0,b.jsx)("option",{value:"",children:"Selecione..."}),u.map(a=>(0,b.jsx)("optgroup",{label:a.nome,children:a.topicos.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.numero," - ",a.titulo]},a.id))},a.id))]})})}),(0,b.jsx)("td",{className:"px-3 py-2",children:(0,b.jsx)("input",{type:"text",defaultValue:a.anotacoes||"",onBlur:b=>y(a.numeroAula,{anotacoes:b.target.value}),placeholder:"...",className:"w-full px-2 py-1 border rounded text-sm"})}),(0,b.jsx)("td",{className:"px-3 py-2 text-center",children:(0,b.jsx)("input",{type:"checkbox",defaultChecked:a.presenca,onChange:b=>y(a.numeroAula,{presenca:b.target.checked}),className:"h-4 w-4"})}),(0,b.jsx)("td",{className:"px-3 py-2 text-center",children:(0,b.jsx)("input",{type:"checkbox",defaultChecked:a.ausencia,onChange:b=>y(a.numeroAula,{ausencia:b.target.checked}),className:"h-4 w-4"})}),(0,b.jsx)("td",{className:"px-3 py-2 text-center",children:(0,b.jsxs)("select",{defaultValue:a.justificativa||"",onChange:b=>y(a.numeroAula,{justificativa:b.target.value||null}),className:"w-16 px-1 py-1 border rounded text-sm",children:[(0,b.jsx)("option",{value:"",children:"-"}),(0,b.jsx)("option",{value:"ENFERMIDADE",children:"E"}),(0,b.jsx)("option",{value:"TRABALHO",children:"T"}),(0,b.jsx)("option",{value:"VIAGEM",children:"V"}),(0,b.jsx)("option",{value:"OUTROS",children:"O"})]})}),(0,b.jsx)("td",{className:"px-3 py-2",children:a.vistoInstrutor?(0,b.jsxs)("span",{className:"text-green-600 flex items-center gap-1 text-xs",children:[(0,b.jsx)(h,{className:"w-3 h-3"}),a.instrutor?.usuario?.nome?.split(" ")[0]||"Ok"]}):(0,b.jsx)(e.Button,{size:"sm",variant:"outline",className:"h-6 text-[10px] px-2",onClick:b=>{b.stopPropagation(),y(a.numeroAula,{vistoInstrutor:!0})},children:"Assinar"})})]},c))})]})})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"AVALIAÇÕES"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Aval. Nº"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Data"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Nota"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Anotações"}),(0,b.jsx)("th",{className:"px-3 py-2 text-center font-medium",children:"Pres."}),(0,b.jsx)("th",{className:"px-3 py-2 text-center font-medium",children:"Aus."}),(0,b.jsx)("th",{className:"px-3 py-2 text-center font-medium",children:"Just.*"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Visto Instrutor"})]})}),(0,b.jsx)("tbody",{children:x.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-3 py-2 font-medium",children:String(a.numeroAvaliacao).padStart(2,"0")}),(0,b.jsx)("td",{className:"px-3 py-2",children:(0,b.jsx)("input",{type:"date",defaultValue:a.data?new Date(a.data).toISOString().split("T")[0]:"",onBlur:b=>z(a.numeroAvaliacao,{data:new Date(b.target.value)}),className:"w-28 px-2 py-1 border rounded text-sm"})}),(0,b.jsx)("td",{className:"px-3 py-2",children:(0,b.jsx)("input",{type:"number",min:"0",max:"10",step:"0.5",defaultValue:a.nota||"",onBlur:b=>z(a.numeroAvaliacao,{nota:b.target.value?parseFloat(b.target.value):null}),className:"w-16 px-2 py-1 border rounded text-sm"})}),(0,b.jsx)("td",{className:"px-3 py-2",children:(0,b.jsx)("input",{type:"text",defaultValue:a.anotacoes||"",placeholder:"Anotações...",onBlur:b=>z(a.numeroAvaliacao,{anotacoes:b.target.value}),className:"w-full px-2 py-1 border rounded text-sm"})}),(0,b.jsx)("td",{className:"px-3 py-2 text-center",children:(0,b.jsx)("input",{type:"checkbox",defaultChecked:a.presenca,onChange:b=>z(a.numeroAvaliacao,{presenca:b.target.checked}),className:"h-4 w-4"})}),(0,b.jsx)("td",{className:"px-3 py-2 text-center",children:(0,b.jsx)("input",{type:"checkbox",defaultChecked:a.ausencia,onChange:b=>z(a.numeroAvaliacao,{ausencia:b.target.checked}),className:"h-4 w-4"})}),(0,b.jsx)("td",{className:"px-3 py-2 text-center",children:(0,b.jsxs)("select",{defaultValue:a.justificativa||"",onChange:b=>z(a.numeroAvaliacao,{justificativa:b.target.value||null}),className:"w-16 px-1 py-1 border rounded text-sm",children:[(0,b.jsx)("option",{value:"",children:"-"}),(0,b.jsx)("option",{value:"ENFERMIDADE",children:"E"}),(0,b.jsx)("option",{value:"TRABALHO",children:"T"}),(0,b.jsx)("option",{value:"VIAGEM",children:"V"}),(0,b.jsx)("option",{value:"OUTROS",children:"O"})]})}),(0,b.jsx)("td",{className:"px-3 py-2",children:a.vistoInstrutor?(0,b.jsxs)("span",{className:"text-green-600 flex items-center gap-1",children:[(0,b.jsx)(h,{className:"w-4 h-4"}),a.instrutor?.usuario?.nome?.split(" ")[0]||"Sim"]}):(0,b.jsx)(e.Button,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>z(a.numeroAvaliacao,{vistoInstrutor:!0}),children:"Assinar"})})]},c))})]})})})]}),(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4 md:gap-8 w-full md:w-auto",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"MÉDIA"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:null!==B?B.toFixed(1):"-"})]}),(0,b.jsxs)("div",{className:"w-full md:w-auto",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Resultado Final"}),(0,b.jsx)("input",{type:"text",placeholder:"Observações...",className:"mt-1 px-3 py-2 border rounded-lg w-full md:w-auto"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"APTO:"}),(0,b.jsxs)("div",{className:"flex gap-4 mt-1",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"apto",value:"true",defaultChecked:!0===k,className:"h-4 w-4"}),(0,b.jsx)("span",{className:"font-medium",children:"SIM"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"apto",value:"false",defaultChecked:!1===k,className:"h-4 w-4"}),(0,b.jsx)("span",{className:"font-medium",children:"NÃO"})]})]})]})]}),(0,b.jsxs)(e.Button,{className:"ml-auto",children:[(0,b.jsx)(g,{className:"w-4 h-4 mr-2"}),"Salvar Ficha"]})]}),(0,b.jsx)("div",{className:"mt-6 pt-4 border-t text-sm text-gray-500",children:(0,b.jsx)("p",{children:"* Justificativas: E - Enfermidade | T - Trabalho | V - Viagem | O - Outros"})}),(0,b.jsx)("div",{className:"mt-6 pt-4 border-t",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Data de Finalização"}),(0,b.jsx)("input",{type:"date",className:"mt-1 px-3 py-2 border rounded-lg w-full"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Encarregado Local"}),(0,b.jsx)("input",{type:"text",defaultValue:l||"",placeholder:"Nome do encarregado",className:"mt-1 w-full px-3 py-2 border rounded-lg"})]})]})})]})})]})}a.s(["FichaForm",()=>i],70256)}];

//# sourceMappingURL=Fichas_GEM_src_1620ff0f._.js.map