(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83385,e=>{"use strict";var a=e.i(46997),t=e.i(3386),s=e.i(33637);let l=t.forwardRef(({className:e,...t},l)=>(0,a.jsx)("div",{ref:l,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));l.displayName="Card";let r=t.forwardRef(({className:e,...t},l)=>(0,a.jsx)("div",{ref:l,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...t}));r.displayName="CardHeader";let n=t.forwardRef(({className:e,...t},l)=>(0,a.jsx)("h3",{ref:l,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));n.displayName="CardTitle";let c=t.forwardRef(({className:e,...t},l)=>(0,a.jsx)("p",{ref:l,className:(0,s.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let d=t.forwardRef(({className:e,...t},l)=>(0,a.jsx)("div",{ref:l,className:(0,s.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",t.forwardRef(({className:e,...t},l)=>(0,a.jsx)("div",{ref:l,className:(0,s.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>l,"CardContent",()=>d,"CardDescription",()=>c,"CardHeader",()=>r,"CardTitle",()=>n])},69407,e=>{"use strict";var a=e.i(46997),t=e.i(3386),s=e.i(83385),l=e.i(38933),r=e.i(74730);let n=(0,r.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),c=(0,r.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function d({fichaId:e,aulas:r,avaliacoes:d,mediaFinal:i,apto:o,encarregadoLocal:x,instrutorId:m,tipoAula:u,nivel:p,livro:h}){let[j,f]=(0,t.useState)(!1),[N,y]=(0,t.useState)(null),[v,g]=(0,t.useState)([]);(0,t.useEffect)(()=>{fetch("/api/msa/fases").then(e=>e.json()).then(e=>g(e)).catch(e=>console.error("Erro ao buscar fases MSA:",e))},[]);let w=Array.from({length:20},(e,a)=>r.find(e=>e.numeroAula===a+1)||{id:null,numeroAula:a+1,data:null,anotacoes:"",topicoMsaId:null,presenca:!1,ausencia:!1,justificativa:null,vistoInstrutor:!1,instrutor:null}),A=Array.from({length:3},(e,a)=>d.find(e=>e.numeroAvaliacao===a+1)||{id:null,numeroAvaliacao:a+1,data:null,nota:null,anotacoes:"",presenca:!1,ausencia:!1,justificativa:null,vistoInstrutor:!1,instrutor:null}),C=async(a,t)=>{f(!0);try{await fetch(`/api/fichas/${e}/aulas`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numeroAula:a,...t,instrutorId:m})}),window.location.reload()}catch(e){console.error("Erro ao salvar aula:",e)}finally{f(!1)}},b=async(a,t)=>{f(!0);try{await fetch(`/api/fichas/${e}/avaliacoes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numeroAvaliacao:a,...t})}),window.location.reload()}catch(e){console.error("Erro ao salvar avaliação:",e)}finally{f(!1)}},S=A.filter(e=>null!==e.nota).map(e=>e.nota),O=S.length>0?S.reduce((e,a)=>e+a,0)/S.length:null;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{className:"text-lg",children:"PROGRAMAÇÃO DE AULAS TEÓRICAS"})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium w-16",children:"Nº"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium w-32",children:"Data"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium min-w-[200px]",children:"Tópico MSA / Assunto"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Anotações"}),(0,a.jsx)("th",{className:"px-3 py-2 text-center font-medium w-10",children:"P."}),(0,a.jsx)("th",{className:"px-3 py-2 text-center font-medium w-10",children:"A."}),(0,a.jsx)("th",{className:"px-3 py-2 text-center font-medium w-16",children:"Just."}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium w-24",children:"Visto"})]})}),(0,a.jsx)("tbody",{children:w.map((e,t)=>(0,a.jsxs)("tr",{onClick:()=>y(t),children:[(0,a.jsx)("td",{className:"px-3 py-2 font-medium",children:String(e.numeroAula).padStart(2,"0")}),(0,a.jsx)("td",{className:"px-3 py-2 text-center",children:(0,a.jsx)("input",{type:"date",defaultValue:e.data?new Date(e.data).toISOString().split("T")[0]:"",onChange:a=>C(e.numeroAula,{data:a.target.value?new Date(a.target.value):void 0}),className:"w-[130px] px-2 py-1 border rounded text-sm"})}),(0,a.jsx)("td",{className:"px-3 py-2",children:("TEORIA_MUSICAL"===u||"SOLFEJO"===u)&&(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("select",{value:e.topicoMsaId||"",onChange:a=>C(e.numeroAula,{topicoMsaId:a.target.value||null}),className:"w-full px-2 py-1 border rounded text-sm max-w-[250px]",children:[(0,a.jsx)("option",{value:"",children:"Selecione..."}),v.map(e=>(0,a.jsx)("optgroup",{label:e.nome,children:e.topicos.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.numero," - ",e.titulo]},e.id))},e.id))]})})}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)("input",{type:"text",defaultValue:e.anotacoes||"",onBlur:a=>C(e.numeroAula,{anotacoes:a.target.value}),placeholder:"...",className:"w-full px-2 py-1 border rounded text-sm"})}),(0,a.jsx)("td",{className:"px-3 py-2 text-center",children:(0,a.jsx)("input",{type:"checkbox",defaultChecked:e.presenca,onChange:a=>C(e.numeroAula,{presenca:a.target.checked}),className:"h-4 w-4"})}),(0,a.jsx)("td",{className:"px-3 py-2 text-center",children:(0,a.jsx)("input",{type:"checkbox",defaultChecked:e.ausencia,onChange:a=>C(e.numeroAula,{ausencia:a.target.checked}),className:"h-4 w-4"})}),(0,a.jsx)("td",{className:"px-3 py-2 text-center",children:(0,a.jsxs)("select",{defaultValue:e.justificativa||"",onChange:a=>C(e.numeroAula,{justificativa:a.target.value||null}),className:"w-16 px-1 py-1 border rounded text-sm",children:[(0,a.jsx)("option",{value:"",children:"-"}),(0,a.jsx)("option",{value:"ENFERMIDADE",children:"E"}),(0,a.jsx)("option",{value:"TRABALHO",children:"T"}),(0,a.jsx)("option",{value:"VIAGEM",children:"V"}),(0,a.jsx)("option",{value:"OUTROS",children:"O"})]})}),(0,a.jsx)("td",{className:"px-3 py-2",children:e.vistoInstrutor?(0,a.jsxs)("span",{className:"text-green-600 flex items-center gap-1 text-xs",children:[(0,a.jsx)(c,{className:"w-3 h-3"}),e.instrutor?.usuario?.nome?.split(" ")[0]||"Ok"]}):(0,a.jsx)(l.Button,{size:"sm",variant:"outline",className:"h-6 text-[10px] px-2",onClick:a=>{a.stopPropagation(),C(e.numeroAula,{vistoInstrutor:!0})},children:"Assinar"})})]},t))})]})})})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{className:"text-lg",children:"AVALIAÇÕES"})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Aval. Nº"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Data"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Nota"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Anotações"}),(0,a.jsx)("th",{className:"px-3 py-2 text-center font-medium",children:"Pres."}),(0,a.jsx)("th",{className:"px-3 py-2 text-center font-medium",children:"Aus."}),(0,a.jsx)("th",{className:"px-3 py-2 text-center font-medium",children:"Just.*"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium",children:"Visto Instrutor"})]})}),(0,a.jsx)("tbody",{children:A.map((e,t)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-3 py-2 font-medium",children:String(e.numeroAvaliacao).padStart(2,"0")}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)("input",{type:"date",defaultValue:e.data?new Date(e.data).toISOString().split("T")[0]:"",onBlur:a=>b(e.numeroAvaliacao,{data:new Date(a.target.value)}),className:"w-28 px-2 py-1 border rounded text-sm"})}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)("input",{type:"number",min:"0",max:"10",step:"0.5",defaultValue:e.nota||"",onBlur:a=>b(e.numeroAvaliacao,{nota:a.target.value?parseFloat(a.target.value):null}),className:"w-16 px-2 py-1 border rounded text-sm"})}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)("input",{type:"text",defaultValue:e.anotacoes||"",placeholder:"Anotações...",onBlur:a=>b(e.numeroAvaliacao,{anotacoes:a.target.value}),className:"w-full px-2 py-1 border rounded text-sm"})}),(0,a.jsx)("td",{className:"px-3 py-2 text-center",children:(0,a.jsx)("input",{type:"checkbox",defaultChecked:e.presenca,onChange:a=>b(e.numeroAvaliacao,{presenca:a.target.checked}),className:"h-4 w-4"})}),(0,a.jsx)("td",{className:"px-3 py-2 text-center",children:(0,a.jsx)("input",{type:"checkbox",defaultChecked:e.ausencia,onChange:a=>b(e.numeroAvaliacao,{ausencia:a.target.checked}),className:"h-4 w-4"})}),(0,a.jsx)("td",{className:"px-3 py-2 text-center",children:(0,a.jsxs)("select",{defaultValue:e.justificativa||"",onChange:a=>b(e.numeroAvaliacao,{justificativa:a.target.value||null}),className:"w-16 px-1 py-1 border rounded text-sm",children:[(0,a.jsx)("option",{value:"",children:"-"}),(0,a.jsx)("option",{value:"ENFERMIDADE",children:"E"}),(0,a.jsx)("option",{value:"TRABALHO",children:"T"}),(0,a.jsx)("option",{value:"VIAGEM",children:"V"}),(0,a.jsx)("option",{value:"OUTROS",children:"O"})]})}),(0,a.jsx)("td",{className:"px-3 py-2",children:e.vistoInstrutor?(0,a.jsxs)("span",{className:"text-green-600 flex items-center gap-1",children:[(0,a.jsx)(c,{className:"w-4 h-4"}),e.instrutor?.usuario?.nome?.split(" ")[0]||"Sim"]}):(0,a.jsx)(l.Button,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>b(e.numeroAvaliacao,{vistoInstrutor:!0}),children:"Assinar"})})]},t))})]})})})]}),(0,a.jsx)(s.Card,{children:(0,a.jsxs)(s.CardContent,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4 md:gap-8 w-full md:w-auto",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"MÉDIA"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:null!==O?O.toFixed(1):"-"})]}),(0,a.jsxs)("div",{className:"w-full md:w-auto",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Resultado Final"}),(0,a.jsx)("input",{type:"text",placeholder:"Observações...",className:"mt-1 px-3 py-2 border rounded-lg w-full md:w-auto"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"APTO:"}),(0,a.jsxs)("div",{className:"flex gap-4 mt-1",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"radio",name:"apto",value:"true",defaultChecked:!0===o,className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:"SIM"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"radio",name:"apto",value:"false",defaultChecked:!1===o,className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:"NÃO"})]})]})]})]}),(0,a.jsxs)(l.Button,{className:"ml-auto",children:[(0,a.jsx)(n,{className:"w-4 h-4 mr-2"}),"Salvar Ficha"]})]}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t text-sm text-gray-500",children:(0,a.jsx)("p",{children:"* Justificativas: E - Enfermidade | T - Trabalho | V - Viagem | O - Outros"})}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Data de Finalização"}),(0,a.jsx)("input",{type:"date",className:"mt-1 px-3 py-2 border rounded-lg w-full"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Encarregado Local"}),(0,a.jsx)("input",{type:"text",defaultValue:x||"",placeholder:"Nome do encarregado",className:"mt-1 w-full px-3 py-2 border rounded-lg"})]})]})})]})})]})}e.s(["FichaForm",()=>d],69407)}]);